# - name: user
#  hosts: demo
#  tasks:
#    - name: Preconfig block
#      block:
#        - name: Create user
#          user:
#            name: "{{ user }}"
#            state: present
#          register: error
#          ignore_errors: true
##          debugger: always
#        - name: Install curl
#          apt:
#            name: curl
#            update-cache: yes
#          register: error
##        - name: Fail on FAILED
##          command: echo "FAILED"
##          register: command_result
##          failed_when: "'FAILED' in command_result.stdout"
#      become: true
#      when: ansible_facts['distribution'] == 'CentOS'
#      rescue:
#        - name: Some error print
#          debug:
#            var: error
#      always:
#        - name: Reboot
#          debug:
#            msg: "Reboooooting"

# - name: user
#  hosts: demo
#  tasks:
#    - name: Preconfig block
#      block:
#        - name: Sleep
#          command: /bin/sleep 15
#          async: 1000
#          poll: 0
#          register: sleep
#        - debug:
#            var: sleep
#        - name: echo
#          command: echo "DONE"
#      become: true
#    - name: Check sleep status
#      async_status:
#        jid: "{{ sleep.ansible_job_id }}"
#      register: job_result
#      until: job_result.finished
#      retries: 100
#      delay: 1
#      become: true

# - name: User
#  hosts: demo
#  tasks:
#    - name: Preconfig block
#      become: true
#      block:
#        - name: Reboot
#          shell: reboot
#          command: /bin/sleep 15
#         async: 1000
#          poll: 0
#          register: sleep
#        - debug:
#            var: sleep
#        - name: echo
#          command: echo "DONE"
#    - name: Check sleep status
#      async_status:
#        jid: "{{ sleep.ansible_job_id }}"
#      register: job_result
#      until: job_result.finished
#      retries: 100
#      delay: 1
#      become: true
